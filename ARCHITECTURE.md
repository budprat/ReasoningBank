# ReasoningBank Architecture

## System Overview

ReasoningBank is a self-evolving AI agent framework that learns from experience through a closed-loop memory system. The architecture enables agents to extract reasoning strategies from both successful and failed attempts, building a persistent knowledge base that improves performance over time.

## Core Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ReasoningBank System                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                            â”‚
â”‚  â”‚   User      â”‚                                                            â”‚
â”‚  â”‚   Query     â”‚                                                            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                            â”‚
â”‚         â”‚                                                                    â”‚
â”‚         â–¼                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚                ReasoningBankAgent                       â”‚                â”‚
â”‚  â”‚                                                         â”‚                â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                â”‚
â”‚  â”‚  â”‚          Closed-Loop Learning Cycle           â”‚    â”‚                â”‚
â”‚  â”‚  â”‚                                               â”‚    â”‚                â”‚
â”‚  â”‚  â”‚   1. RETRIEVE â”€â”€â–º 2. ACT â”€â”€â–º 3. JUDGE       â”‚    â”‚                â”‚
â”‚  â”‚  â”‚        â–²                           â”‚         â”‚    â”‚                â”‚
â”‚  â”‚  â”‚        â”‚                           â–¼         â”‚    â”‚                â”‚
â”‚  â”‚  â”‚   5. CONSOLIDATE â—„â”€â”€ 4. EXTRACT             â”‚    â”‚                â”‚
â”‚  â”‚  â”‚                                               â”‚    â”‚                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        Core Components                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚                                                                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚   â”‚
â”‚  â”‚  â”‚  Retriever   â”‚  â”‚    Judge     â”‚  â”‚  Extractor   â”‚             â”‚   â”‚
â”‚  â”‚  â”‚              â”‚  â”‚              â”‚  â”‚              â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Embedding  â”‚  â”‚ â€¢ Success/   â”‚  â”‚ â€¢ Dual-      â”‚             â”‚   â”‚
â”‚  â”‚  â”‚   Search     â”‚  â”‚   Failure    â”‚  â”‚   Prompt     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Similarity â”‚  â”‚   Detection  â”‚  â”‚ â€¢ Strategy   â”‚             â”‚   â”‚
â”‚  â”‚  â”‚   Ranking    â”‚  â”‚ â€¢ Binary     â”‚  â”‚   Mining     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚ â€¢ Top-k      â”‚  â”‚   Signal     â”‚  â”‚ â€¢ Lesson     â”‚             â”‚   â”‚
â”‚  â”‚  â”‚   Selection  â”‚  â”‚              â”‚  â”‚   Extraction â”‚             â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚   â”‚
â”‚  â”‚         â”‚                  â”‚                  â”‚                      â”‚   â”‚
â”‚  â”‚         â–¼                  â–¼                  â–¼                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚   â”‚
â”‚  â”‚  â”‚                   Consolidator                        â”‚         â”‚   â”‚
â”‚  â”‚  â”‚                                                       â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Memory Bank Management                            â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Simple Addition (No Deduplication)                â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Persistent Storage (JSON)                         â”‚         â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ Import/Export Support                             â”‚         â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚   â”‚
â”‚  â”‚                              â”‚                                      â”‚   â”‚
â”‚  â”‚                              â–¼                                      â”‚   â”‚
â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚   â”‚
â”‚  â”‚         â”‚        Memory Bank Storage          â”‚                    â”‚   â”‚
â”‚  â”‚         â”‚                                     â”‚                    â”‚   â”‚
â”‚  â”‚         â”‚  ğŸ“ memory_bank.json               â”‚                    â”‚   â”‚
â”‚  â”‚         â”‚  â€¢ MemoryEntry objects             â”‚                    â”‚   â”‚
â”‚  â”‚         â”‚  â€¢ MemoryItem collections          â”‚                    â”‚   â”‚
â”‚  â”‚         â”‚  â€¢ Embeddings cache                â”‚                    â”‚   â”‚
â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Detailed Component Flow

### 1. Core Agent Execution Flow

```
User Query
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. RETRIEVE (Retriever)        â”‚
â”‚                                 â”‚
â”‚  Input: query, memory_bank      â”‚
â”‚  Process:                       â”‚
â”‚  â€¢ Generate query embedding     â”‚
â”‚  â€¢ Compute cosine similarity    â”‚
â”‚  â€¢ Rank all memories            â”‚
â”‚  â€¢ Return top-k relevant        â”‚
â”‚  Output: List[MemoryItem]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. ACT (Agent Executor)        â”‚
â”‚                                 â”‚
â”‚  Input: query, memories         â”‚
â”‚  Process:                       â”‚
â”‚  â€¢ Augment prompt with memories â”‚
â”‚  â€¢ ReAct loop execution         â”‚
â”‚  â€¢ Environment interaction      â”‚
â”‚  â€¢ Track trajectory steps       â”‚
â”‚  Output: trajectory, state      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. JUDGE (Judge)               â”‚
â”‚                                 â”‚
â”‚  Input: query, trajectory       â”‚
â”‚  Process:                       â”‚
â”‚  â€¢ Analyze final state          â”‚
â”‚  â€¢ Determine success/failure    â”‚
â”‚  â€¢ Binary classification        â”‚
â”‚  Output: bool (success)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. EXTRACT (Extractor)         â”‚
â”‚                                 â”‚
â”‚  Input: trajectory, success     â”‚
â”‚  Process:                       â”‚
â”‚  â€¢ Dual-prompt extraction       â”‚
â”‚  â€¢ Success â†’ strategies         â”‚
â”‚  â€¢ Failure â†’ lessons            â”‚
â”‚  â€¢ Structure as MemoryItems     â”‚
â”‚  Output: List[MemoryItem]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. CONSOLIDATE (Consolidator)  â”‚
â”‚                                 â”‚
â”‚  Input: memory_items            â”‚
â”‚  Process:                       â”‚
â”‚  â€¢ Create MemoryEntry           â”‚
â”‚  â€¢ Simple addition to bank      â”‚
â”‚  â€¢ No deduplication             â”‚
â”‚  â€¢ Save to JSON storage         â”‚
â”‚  Output: entry_id               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. MaTTS (Memory-Aware Test-Time Scaling) Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MaTTS Scaling Strategies                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              MaTTS PARALLEL (Breadth)                   â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚     Query â”€â”€â”¬â”€â”€â–º Agent 1 â”€â”€â–º Trajectory 1             â”‚    â”‚
â”‚  â”‚             â”œâ”€â”€â–º Agent 2 â”€â”€â–º Trajectory 2             â”‚    â”‚
â”‚  â”‚             â””â”€â”€â–º Agent 3 â”€â”€â–º Trajectory 3             â”‚    â”‚
â”‚  â”‚                      â”‚                                 â”‚    â”‚
â”‚  â”‚                      â–¼                                 â”‚    â”‚
â”‚  â”‚              Memory Aggregation                        â”‚    â”‚
â”‚  â”‚                      â”‚                                 â”‚    â”‚
â”‚  â”‚                      â–¼                                 â”‚    â”‚
â”‚  â”‚              Select Best Result                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚             MaTTS SEQUENTIAL (Depth)                    â”‚    â”‚
â”‚  â”‚                                                         â”‚    â”‚
â”‚  â”‚     Query â”€â”€â–º Agent 1 â”€â”€â–º Memory 1                     â”‚    â”‚
â”‚  â”‚                  â”‚            â”‚                         â”‚    â”‚
â”‚  â”‚                  â–¼            â–¼                         â”‚    â”‚
â”‚  â”‚              Agent 2 â”€â”€â–º Memory 1+2                    â”‚    â”‚
â”‚  â”‚                  â”‚            â”‚                         â”‚    â”‚
â”‚  â”‚                  â–¼            â–¼                         â”‚    â”‚
â”‚  â”‚              Agent 3 â”€â”€â–º Memory 1+2+3                  â”‚    â”‚
â”‚  â”‚                  â”‚                                      â”‚    â”‚
â”‚  â”‚                  â–¼                                      â”‚    â”‚
â”‚  â”‚          Progressive Refinement                         â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Model Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Data Model Hierarchy                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  TrajectoryResult                                              â”‚
â”‚  â”œâ”€â”€ query: str                                                â”‚
â”‚  â”œâ”€â”€ full_trajectory: str                                      â”‚
â”‚  â”œâ”€â”€ success: bool                                             â”‚
â”‚  â””â”€â”€ memory_items: List[MemoryItem]                            â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚  MemoryEntry (Stored in Memory Bank)                           â”‚
â”‚  â”œâ”€â”€ id: str (UUID)                                           â”‚
â”‚  â”œâ”€â”€ task_query: str                                          â”‚
â”‚  â”œâ”€â”€ trajectory: str                                          â”‚
â”‚  â”œâ”€â”€ success: bool                                            â”‚
â”‚  â”œâ”€â”€ timestamp: float                                         â”‚
â”‚  â””â”€â”€ memory_items: List[MemoryItem]                           â”‚
â”‚                          â”‚                                      â”‚
â”‚                          â–¼                                      â”‚
â”‚  MemoryItem (Reusable Knowledge Unit)                          â”‚
â”‚  â”œâ”€â”€ title: str                                               â”‚
â”‚  â”œâ”€â”€ description: str                                         â”‚
â”‚  â”œâ”€â”€ content: str                                             â”‚
â”‚  â”œâ”€â”€ source_task_id: str                                      â”‚
â”‚  â””â”€â”€ success_signal: bool                                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Component Interactions

### LLM Provider Integration

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         LLM Provider Layer             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚Anthropic â”‚  â”‚  OpenAI  â”‚  â”‚Googleâ”‚â”‚
â”‚  â”‚  Claude  â”‚  â”‚   GPT-4  â”‚  â”‚Geminiâ”‚â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”˜â”‚
â”‚       â”‚              â”‚            â”‚    â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                  â–¼                     â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚  Agent Core    â”‚             â”‚
â”‚         â”‚  Judge         â”‚             â”‚
â”‚         â”‚  Extractor     â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Embedding System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Embedding Pipeline                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  Text Input                                 â”‚
â”‚      â”‚                                      â”‚
â”‚      â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚  â”‚ Embedding Cache â”‚â”€â”€â–º Cached? â”€â”€â–º Return â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚      â”‚ Not Cached                          â”‚
â”‚      â–¼                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   Embedding Provider    â”‚               â”‚
â”‚  â”‚ â€¢ OpenAI (1536 dim)     â”‚               â”‚
â”‚  â”‚ â€¢ Google (768 dim)      â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚      â”‚                                      â”‚
â”‚      â–¼                                      â”‚
â”‚  Store in Cache                             â”‚
â”‚      â”‚                                      â”‚
â”‚      â–¼                                      â”‚
â”‚  Return Embedding Vector                    â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Memory Growth Strategy (Gap 22)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Memory Bank Growth Pattern            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                              â”‚
â”‚  Task 1 â”€â”€â–º Memory 1                         â”‚
â”‚  Task 2 â”€â”€â–º Memory 1, 2                      â”‚
â”‚  Task 3 â”€â”€â–º Memory 1, 2, 3                   â”‚
â”‚  ...                                         â”‚
â”‚  Task N â”€â”€â–º Memory 1, 2, 3, ..., N           â”‚
â”‚                                              â”‚
â”‚  Properties:                                 â”‚
â”‚  â€¢ Linear growth (no deduplication)          â”‚
â”‚  â€¢ Unbounded accumulation                    â”‚
â”‚  â€¢ Simple addition strategy                  â”‚
â”‚  â€¢ Performance target: <5s retrieval @ 1000+ â”‚
â”‚                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Testing Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Testing Framework                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                  â”‚
â”‚  Unit Tests                                      â”‚
â”‚  â”œâ”€â”€ test_config.py                             â”‚
â”‚  â”œâ”€â”€ test_models.py                             â”‚
â”‚  â”œâ”€â”€ test_judge.py                              â”‚
â”‚  â”œâ”€â”€ test_extractor.py                          â”‚
â”‚  â”œâ”€â”€ test_retriever.py                          â”‚
â”‚  â””â”€â”€ test_consolidator.py                       â”‚
â”‚                                                  â”‚
â”‚  Integration Tests (E2E)                        â”‚
â”‚  â”œâ”€â”€ test_streaming_constraint.py (Gap 21)      â”‚
â”‚  â”œâ”€â”€ test_progressive_learning.py (Gap 1)       â”‚
â”‚  â””â”€â”€ test_context_dependent.py (Gap 2)          â”‚
â”‚                                                  â”‚
â”‚  Ablation Tests                                 â”‚
â”‚  â””â”€â”€ test_success_and_failure_extraction.py     â”‚
â”‚      (Gap 24 - Core innovation validation)      â”‚
â”‚                                                  â”‚
â”‚  Stress Tests                                   â”‚
â”‚  â””â”€â”€ test_memory_growth_long_term.py (Gap 22)   â”‚
â”‚      â€¢ 10-task quick validation                 â”‚
â”‚      â€¢ 100-task growth test                     â”‚
â”‚      â€¢ 334-task performance test                â”‚
â”‚                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Configuration System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Configuration Architecture              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                 â”‚
â”‚  ReasoningBankConfig                           â”‚
â”‚  â”œâ”€â”€ LLM Settings                              â”‚
â”‚  â”‚   â”œâ”€â”€ provider: anthropic|openai|google     â”‚
â”‚  â”‚   â”œâ”€â”€ model: claude-3|gpt-4|gemini         â”‚
â”‚  â”‚   â””â”€â”€ temperatures: agent|judge|extractor   â”‚
â”‚  â”‚                                             â”‚
â”‚  â”œâ”€â”€ Memory Settings                           â”‚
â”‚  â”‚   â”œâ”€â”€ memory_bank_path: str                â”‚
â”‚  â”‚   â”œâ”€â”€ embedding_model: str                 â”‚
â”‚  â”‚   â”œâ”€â”€ top_k_retrieval: int                 â”‚
â”‚  â”‚   â””â”€â”€ extract_from_failures: bool          â”‚
â”‚  â”‚                                             â”‚
â”‚  â””â”€â”€ Execution Settings                        â”‚
â”‚      â”œâ”€â”€ max_steps_per_task: int              â”‚
â”‚      â””â”€â”€ enable_memory_injection: bool        â”‚
â”‚                                                 â”‚
â”‚  Preset Configurations                         â”‚
â”‚  â”œâ”€â”€ get_config_for_claude()                  â”‚
â”‚  â”œâ”€â”€ get_config_for_paper_replication()       â”‚
â”‚  â”œâ”€â”€ get_config_for_matts_parallel()          â”‚
â”‚  â””â”€â”€ get_config_for_matts_sequential()        â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Key Architectural Decisions

1. **Closed-Loop Learning**: Every task execution feeds back into the memory bank
2. **Simple Addition Strategy**: No deduplication or pruning (intentional design)
3. **Dual-Prompt Extraction**: Different prompts for success vs failure extraction
4. **Embedding-Based Retrieval**: Semantic similarity for memory selection
5. **JSON Persistence**: Human-readable, portable memory storage
6. **Provider Agnostic**: Supports multiple LLM providers transparently
7. **Test-Time Scaling**: Two strategies (parallel breadth, sequential depth)

## Performance Characteristics

- **Memory Retrieval**: O(n) complexity, <5s for 1000+ memories
- **Embedding Generation**: Cached to minimize API calls
- **Memory Growth**: Linear with task count
- **Storage Format**: JSON (human-readable, ~1-5KB per memory)
- **API Efficiency**: Batch operations where supported

## Future Architecture Considerations

1. **Vector Database Integration**: For scaling beyond 10,000 memories
2. **Memory Pruning Strategies**: Optional deduplication/compression
3. **Distributed Execution**: Multi-agent coordination
4. **Real-time Learning**: Stream processing for continuous learning
5. **Memory Versioning**: Track memory evolution over time